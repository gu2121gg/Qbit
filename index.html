<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qbit | Secure Project Host</title>
    
    <!-- Tailwind CSS (Framework de Estilo Moderno) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Ícones (FontAwesome) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Configuração de Fonte e Estilos Extras -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #050505;
            color: #ffffff;
            overflow-x: hidden;
        }

        /* Classe para efeito de vidro (Glassmorphism) */
        .glass {
            background: rgba(20, 20, 20, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }

        /* Animação de entrada suave */
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Input customizado */
        .qbit-input {
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid #333;
            color: white;
            transition: all 0.3s ease;
        }
        .qbit-input:focus {
            border-color: #fff;
            outline: none;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }

        /* Scrollbar customizada */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0a0a0a; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }

        /* Vídeo de Fundo */
        #bg-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1;
            object-fit: cover;
            filter: grayscale(100%) brightness(0.3) contrast(1.2);
        }
    </style>
</head>
<body class="antialiased min-h-screen flex flex-col">

    <!-- VÍDEO DE FUNDO (Loop Tech) -->
    <video autoplay muted loop id="bg-video">
        <source src="https://assets.mixkit.co/videos/preview/mixkit-black-and-white-graphic-lines-background-3079-large.mp4" type="video/mp4">
        Seu navegador não suporta vídeos HTML5.
    </video>

    <!-- NOTIFICAÇÕES (Toast) -->
    <div id="toast" class="fixed top-5 right-5 z-50 transform translate-x-full transition-transform duration-300">
        <div class="glass px-6 py-4 rounded-lg shadow-xl flex items-center gap-3">
            <i class="fas fa-info-circle text-white"></i>
            <span id="toast-msg" class="text-sm font-medium">Notificação</span>
        </div>
    </div>

    <!-- TELA DE LOGIN -->
    <section id="login-screen" class="flex-grow flex items-center justify-center p-4">
        <div class="glass p-8 md:p-12 rounded-2xl w-full max-w-md fade-in relative overflow-hidden">
            <!-- Detalhe decorativo -->
            <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-white to-transparent opacity-20"></div>

            <div class="text-center mb-8">
                <h1 class="text-4xl font-extrabold tracking-tighter mb-2">QBIT.</h1>
                <p class="text-gray-400 text-sm">Acesso restrito ao terminal.</p>
            </div>

            <form id="login-form" class="space-y-5">
                <div>
                    <label class="block text-xs uppercase tracking-wider text-gray-500 mb-1">Email</label>
                    <input type="email" id="email" class="qbit-input w-full p-3 rounded-lg" placeholder="admin@qbit.com" required>
                </div>
                <div>
                    <label class="block text-xs uppercase tracking-wider text-gray-500 mb-1">Senha</label>
                    <input type="password" id="password" class="qbit-input w-full p-3 rounded-lg" placeholder="••••••••" required>
                </div>
                
                <button type="submit" class="w-full bg-white text-black font-bold py-3 rounded-lg hover:bg-gray-200 transition-colors transform hover:scale-[1.02] active:scale-95">
                    <i class="fas fa-fingerprint mr-2"></i> ACESSAR SISTEMA
                </button>
            </form>

            <div class="mt-6 text-center text-xs text-gray-600">
                <p>Protegido por criptografia Qbit-256.</p>
            </div>
        </div>
    </section>

    <!-- TELA DO SISTEMA (Dashboard) - Inicialmente Oculta -->
    <section id="app-screen" class="hidden flex-col min-h-screen">
        
        <!-- Navbar -->
        <nav class="glass sticky top-0 z-40 border-b border-gray-800">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center gap-2">
                        <span class="text-2xl font-bold tracking-tighter">QBIT<span class="text-gray-500">_HOST</span></span>
                    </div>
                    <div class="flex items-center gap-4">
                        <span id="user-display" class="hidden md:block text-sm text-gray-400">usuario@qbit.com</span>
                        <button id="btn-logout" class="text-sm border border-gray-700 hover:border-white px-4 py-1.5 rounded-full transition-all">
                            Sair
                        </button>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Conteúdo Principal -->
        <main class="flex-grow p-6 md:p-10 max-w-7xl mx-auto w-full">
            
            <!-- Cabeçalho da Dash -->
            <div class="flex flex-col md:flex-row justify-between items-end mb-10 gap-4 fade-in">
                <div>
                    <h2 class="text-3xl font-bold mb-2">Meus Projetos</h2>
                    <p class="text-gray-400 text-sm">Gerencie seus deploys e repositórios ativos.</p>
                </div>
                <button onclick="toggleModal()" class="bg-zinc-800 hover:bg-zinc-700 text-white px-5 py-2 rounded-lg text-sm font-medium transition flex items-center gap-2 border border-zinc-700">
                    <i class="fas fa-plus"></i> Novo Projeto
                </button>
            </div>

            <!-- Grid de Projetos -->
            <div id="projects-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Os projetos serão injetados aqui via JavaScript -->
                <div class="glass rounded-xl p-8 flex items-center justify-center text-gray-500 h-64 animate-pulse">
                    Carregando dados...
                </div>
            </div>

        </main>

        <footer class="text-center py-6 text-xs text-gray-600 border-t border-gray-900 glass mt-auto">
            QBIT SYSTEMS &copy; 2025
        </footer>

        <!-- MODAL DE NOVO PROJETO -->
        <div id="modal" class="fixed inset-0 bg-black bg-opacity-80 backdrop-blur-sm z-50 hidden flex items-center justify-center p-4">
            <div class="glass w-full max-w-md rounded-xl p-6 relative fade-in border border-gray-800">
                <button onclick="toggleModal()" class="absolute top-4 right-4 text-gray-500 hover:text-white">
                    <i class="fas fa-times"></i>
                </button>
                
                <h3 class="text-xl font-bold mb-4">Adicionar Projeto</h3>
                
                <form id="add-project-form" class="space-y-4">
                    <div>
                        <label class="text-xs text-gray-400">Nome do Projeto</label>
                        <input type="text" id="proj-name" class="qbit-input w-full p-2 rounded mt-1" required>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Descrição Curta</label>
                        <input type="text" id="proj-desc" class="qbit-input w-full p-2 rounded mt-1" required>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">Link (URL)</label>
                        <input type="url" id="proj-link" class="qbit-input w-full p-2 rounded mt-1" placeholder="https://" required>
                    </div>
                    
                    <button type="submit" class="w-full bg-white text-black font-bold py-2 rounded mt-4 hover:bg-gray-200">
                        Salvar Projeto
                    </button>
                </form>
            </div>
        </div>

    </section>

    <!-- FIREBASE & LÓGICA DO APP -->
    <script type="module">
        // --- 1. CONFIGURAÇÃO FIREBASE (IMPORTANTE: PREENCHA COM SEUS DADOS) ---
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";
        import { getFirestore, collection, addDoc, getDocs, query, where, orderBy } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";

        // !!! SUBSTITUA O OBJETO ABAIXO PELAS SUAS CHAVES DO CONSOLE DO FIREBASE !!!
        const firebaseConfig = {
            apiKey: "SUA_API_KEY_AQUI",
            authDomain: "seu-projeto.firebaseapp.com",
            projectId: "seu-projeto",
            storageBucket: "seu-projeto.appspot.com",
            messagingSenderId: "00000000000",
            appId: "1:00000000:web:00000000000"
        };

        // NOTA: Se você não configurar o firebaseConfig acima, usaremos dados fictícios (Local Storage) para demonstração.
        const isDemoMode = firebaseConfig.apiKey === "SUA_API_KEY_AQUI";
        
        // Inicialização Condicional
        let auth, db;
        if (!isDemoMode) {
            const app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
        }

        // --- 2. LÓGICA DA INTERFACE (UI) ---

        const loginScreen = document.getElementById('login-screen');
        const appScreen = document.getElementById('app-screen');
        const loginForm = document.getElementById('login-form');
        const logoutBtn = document.getElementById('btn-logout');
        const projectsGrid = document.getElementById('projects-grid');
        const addProjectForm = document.getElementById('add-project-form');
        const toast = document.getElementById('toast');

        // Função para mostrar notificação
        window.showToast = (msg) => {
            document.getElementById('toast-msg').innerText = msg;
            toast.classList.remove('translate-x-full');
            setTimeout(() => toast.classList.add('translate-x-full'), 3000);
        }

        // Alternar Modal
        window.toggleModal = () => {
            const modal = document.getElementById('modal');
            modal.classList.toggle('hidden');
        }

        // Trocar Telas
        function switchScreen(isLoggedIn) {
            if (isLoggedIn) {
                loginScreen.classList.add('hidden');
                appScreen.classList.remove('hidden');
                appScreen.classList.add('flex');
                loadProjects();
            } else {
                appScreen.classList.add('hidden');
                appScreen.classList.remove('flex');
                loginScreen.classList.remove('hidden');
            }
        }

        // --- 3. AUTENTICAÇÃO ---

        loginForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            if (isDemoMode) {
                // Simulação de login para demonstração
                if(email && password.length > 5) {
                    localStorage.setItem('qbit_user', email);
                    showToast('Acesso Demo Concedido');
                    switchScreen(true);
                } else {
                    showToast('Erro: Senha curta ou email inválido');
                }
            } else {
                // Login Real com Firebase
                try {
                    await signInWithEmailAndPassword(auth, email, password);
                    showToast('Bem-vindo ao Qbit');
                } catch (error) {
                    showToast('Erro: ' + error.message);
                }
            }
        });

        logoutBtn.addEventListener('click', async () => {
            if (isDemoMode) {
                localStorage.removeItem('qbit_user');
                switchScreen(false);
            } else {
                await signOut(auth);
            }
            showToast('Sessão encerrada');
        });

        // Monitorar Estado (Real ou Demo)
        if (isDemoMode) {
            const user = localStorage.getItem('qbit_user');
            if (user) {
                document.getElementById('user-display').innerText = user;
                switchScreen(true);
            }
        } else {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    document.getElementById('user-display').innerText = user.email;
                    switchScreen(true);
                } else {
                    switchScreen(false);
                }
            });
        }

        // --- 4. GESTÃO DE PROJETOS (FIRESTORE + LOCAL MOCK) ---

        // Renderizar um card
        function createCardHTML(project) {
            return `
                <div class="glass rounded-xl overflow-hidden border border-zinc-800 hover:border-zinc-500 transition-all duration-300 transform hover:-translate-y-2 group">
                    <div class="h-32 bg-zinc-900 relative overflow-hidden">
                        <!-- Placeholder visual gerado com CSS -->
                        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-zinc-800 to-black opacity-50"></div>
                        <div class="absolute inset-0 flex items-center justify-center text-4xl text-zinc-800 group-hover:text-white transition-colors">
                            <i class="fas fa-cube"></i>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-white mb-1">${project.name}</h3>
                        <p class="text-sm text-gray-400 mb-4 h-10 overflow-hidden">${project.desc}</p>
                        <div class="flex justify-between items-center mt-4 pt-4 border-t border-zinc-800">
                            <span class="text-xs text-zinc-500 font-mono">ID: ${project.id ? project.id.substring(0,6) : 'LOCAL'}</span>
                            <a href="${project.link}" target="_blank" class="text-xs bg-white text-black px-3 py-1.5 rounded font-bold hover:bg-gray-300 transition">
                                ABRIR
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        async function loadProjects() {
            projectsGrid.innerHTML = '';
            let projects = [];

            if (isDemoMode) {
                // Carregar do LocalStorage ou usar dados iniciais
                const stored = localStorage.getItem('qbit_projects');
                if (stored) {
                    projects = JSON.parse(stored);
                } else {
                    projects = [
                        { name: "Website Institucional", desc: "Landing page corporativa com design clean.", link: "#" },
                        { name: "Bot Discord", desc: "Automação em Node.js para servidores.", link: "#" }
                    ];
                }
            } else {
                // Carregar do Firestore
                // Nota: Requer regras do Firestore configuradas para leitura/escrita
                try {
                    const q = query(collection(db, "projects")); // Add where("uid", "==", auth.currentUser.uid) para segurança
                    const querySnapshot = await getDocs(q);
                    querySnapshot.forEach((doc) => {
                        projects.push({ id: doc.id, ...doc.data() });
                    });
                } catch (e) {
                    console.error("Erro ao buscar projetos:", e);
                    showToast("Erro ao carregar do banco de dados.");
                }
            }

            // Renderizar
            if (projects.length === 0) {
                projectsGrid.innerHTML = '<p class="text-gray-500 col-span-3 text-center">Nenhum projeto encontrado.</p>';
            } else {
                projects.forEach(p => {
                    projectsGrid.innerHTML += createCardHTML(p);
                });
            }
        }

        addProjectForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('proj-name').value;
            const desc = document.getElementById('proj-desc').value;
            const link = document.getElementById('proj-link').value;

            const newProject = { name, desc, link, date: new Date().toISOString() };

            if (isDemoMode) {
                let projects = JSON.parse(localStorage.getItem('qbit_projects') || '[]');
                projects.push(newProject);
                localStorage.setItem('qbit_projects', JSON.stringify(projects));
                loadProjects();
                toggleModal();
                addProjectForm.reset();
                showToast('Projeto salvo (Local)');
            } else {
                try {
                    await addDoc(collection(db, "projects"), {
                        ...newProject,
                        uid: auth.currentUser.uid // Salvar quem criou
                    });
                    loadProjects();
                    toggleModal();
                    addProjectForm.reset();
                    showToast('Projeto salvo na Nuvem');
                } catch (e) {
                    showToast('Erro ao salvar: ' + e.message);
                }
            }
        });

    </script>
</body>
</html>
